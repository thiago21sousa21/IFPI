-- 1. Livros que possuam preços superiores a R$ 50,00.
SELECT *
FROM livro
WHERE preco > 50;

-- 2. Livros que possuam preços entre R$ 100,00 e R$ 200,00.
SELECT *
FROM livro
WHERE preco BETWEEN 100 AND 200;

SELECT *
FROM livro
WHERE preco >= 100 AND preco <= 200;

-- 3. Livros cujos títulos possuam a palavra ‘Banco’.
SELECT titulo
FROM livro
WHERE LOWER(titulo) LIKE '%banco%';

-- 4. Livros cujos títulos iniciam com a palavra ‘Banco’.
SELECT *
FROM livro
WHERE preco BETWEEN 100 AND 200;

SELECT *
FROM livro
WHERE preco >= 100 AND preco <= 200;

-- 3. Livros cujos títulos possuam a palavra ‘Banco’.
SELECT titulo
FROM livro
WHERE LOWER(titulo) LIKE '%banco%';

-- 4. Livros cujos títulos iniciam com a palavra ‘Banco’.
SELECT titulo
FROM livro
WHERE LOWER(titulo) LIKE 'banco%';

-- 5. Livros cujos títulos terminam com a palavra ‘Dados’.
SELECT titulo
FROM livro
WHERE LOWER(titulo) LIKE '%dados';

-- 6. Livros cujos títulos possuem a expressão ‘Banco de Dados’ ou ‘Bancos de Dados’.

SELECT titulo
FROM livro
WHERE LOWER(titulo) LIKE '%banco de dados%'
OR LOWER(titulo) LIKE '%bancos de dados%';

-- 7. Livros que foram lançados há mais de 5 anos.

SELECT *
FROM livro
WHERE dataLancamento < DATE_SUB(CURDATE(), INTERVAL 5 YEAR);

-- 8. Livros que ainda não foram lançados, ou seja, com a data de lançamento nula.

SELECT *
FROM livro
WHERE dataLancamento IS NULL;

-- 9. Livros cujo assunto seja ‘Estruturas de Dados’.

SELECT * 
FROM livro
JOIN assunto ON livro.assunto_codigo = assunto.codigo
WHERE LOWER(assunto.descricao) LIKE'%estruturas de dados%';

-- 10. Livros cujo assunto tenha código 1, 2 ou 3.

SELECT * FROM livro
WHERE assunto_codigo IN (1, 2, 3);

-- 11. Quantidade de livros
SELECT COUNT(*) AS quantidade_livros FROM livro;

-- 12. Quantidade de livros ainda não lançados (data nula)
SELECT COUNT(*) AS livros_nao_lancados
FROM livro
WHERE dataLancamento IS NULL;

-- 13. Soma dos preços dos livros
SELECT SUM(preco) AS soma_precos FROM livro;

-- 14. Média dos preços dos livros
SELECT AVG(preco) AS media_precos FROM livro;

-- 15. Maior preço dos livros
SELECT MAX(preco) AS maior_preco FROM livro;

-- 16. Menor preço dos livros
SELECT MIN(preco) AS menor_preco FROM livro;

-- 17. Preço médio dos livros para cada assunto
SELECT a.descricao AS assunto, ROUND(AVG(l.preco), 2) AS preco_medio
FROM livro l
JOIN assunto a ON l.assunto_codigo = a.codigo
GROUP BY a.descricao;

-- 18. Quantidade de livros para cada assunto
SELECT a.descricao AS assunto, COUNT(*) AS quantidade
FROM livro l
JOIN assunto a ON l.assunto_codigo = a.codigo
GROUP BY a.descricao;

-- 19. Preço do livro mais caro de cada assunto (somente os já lançados)
SELECT a.descricao AS assunto, MAX(l.preco) AS preco_maximo
FROM livro l
JOIN assunto a ON l.assunto_codigo = a.codigo
WHERE l.dataLancamento IS NOT NULL
GROUP BY a.descricao;

-- 20. Quantidade de livros lançados por editora
SELECT e.nome AS editora, COUNT(*) AS livros_lancados
FROM livro l
JOIN editora e ON l.editora_codigo = e.codigo
WHERE l.dataLancamento IS NOT NULL
GROUP BY e.nome;

-- 21. Assuntos cujo preço médio dos livros ultrapassa R$ 50,00.
SELECT a.descricao AS assunto, AVG(l.preco) AS media_preco
FROM livro l
JOIN assunto a ON l.assunto_codigo = a.codigo
GROUP BY a.descricao
HAVING AVG(l.preco) > 50.00;

-- 22. Assuntos que possuem pelo menos 2 livros.
SELECT a.descricao AS assunto, COUNT(*) AS quantidade
FROM livro l
JOIN assunto a ON l.assunto_codigo = a.codigo
GROUP BY a.descricao
HAVING COUNT(*) >= 2;

-- 23. Assuntos que possuem pelo menos 2 livros já lançados.
SELECT a.descricao AS assunto, COUNT(*) AS quantidade_lancados
FROM livro l
JOIN assunto a ON l.assunto_codigo = a.codigo
WHERE l.dataLancamento IS NOT NULL
GROUP BY a.descricao
HAVING COUNT(*) >= 2;

-- 24. Quantidade de livros lançados por assunto.
SELECT a.descricao AS assunto, COUNT(*) AS livros_lancados
FROM livro l
JOIN assunto a ON l.assunto_codigo = a.codigo
WHERE l.dataLancamento IS NOT NULL
GROUP BY a.descricao;

-- 25. Nome e passaporte dos autores que possuem a palavra ‘João’ no nome.
SELECT nome, passaporte
FROM autor
WHERE nome LIKE '%João%';

-- 26. Nome e passaporte dos autores que nasceram após 1° de janeiro de 1970.
SELECT nome, passaporte
FROM autor
WHERE dataNascimento > '1970-01-01';

-- 27. Nome e passaporte dos autores que não são brasileiros.
SELECT a.nome, a.passaporte
FROM autor a
JOIN nacionalidade n ON a.nacionalidade_codigo = n.codigo
WHERE n.pais != 'Brasil';

-- 28. Quantidade de autores.
SELECT COUNT(*) AS quantidade_autores FROM autor;

-- 29. Quantidade média de autores dos livros.
SELECT AVG(qtd_autores) AS media_autores_por_livro
FROM (
    SELECT COUNT(*) AS qtd_autores
    FROM autor_livro
    GROUP BY livro_codigo
) AS subconsulta;

-- 30. Livros que possuem ao menos 2 autores.
SELECT l.titulo, COUNT(al.autor_codigo) AS qtd_autores
FROM livro l
JOIN autor_livro al ON l.codigo = al.livro_codigo
GROUP BY l.codigo, l.titulo
HAVING COUNT(al.autor_codigo) >= 2;
